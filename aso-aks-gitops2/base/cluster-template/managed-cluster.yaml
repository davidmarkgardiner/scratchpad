apiVersion: containerservice.azure.com/v1api20240901
kind: ManagedCluster
metadata:
  name: placeholder-name
  namespace: azureserviceoperator-system
spec:
  location: placeholder-location
  owner:
    name: placeholder-rg
  dnsPrefix: placeholder-prefix
  kubernetesVersion: placeholder-k8s-version
  identity:
    type: UserAssigned
    userAssignedIdentities:
      - reference:
          armId: placeholder-control-plane-identity
  servicePrincipalProfile:
    clientId: placeholder-runtime-client-id
    objectId: placeholder-runtime-object-id
  aadProfile:
    enableAzureRBAC: true
    managed: true
    adminGroupObjectIDs: ["placeholder-admin-group"]
  enableRBAC: true
  disableLocalAccounts: true
  networkProfile:
    networkPlugin: azure
    networkPluginMode: overlay
    networkPolicy: cilium
    networkDataplane: cilium
    serviceCidr: placeholder-service-cidr
    dnsServiceIP: placeholder-dns-ip
    podCidr: placeholder-pod-cidr
    ipFamilies: ["IPv4"]
    loadBalancerSku: standard
    outboundType: userDefinedRouting
  apiServerAccessProfile:
    enablePrivateCluster: true
    enablePrivateClusterPublicFQDN: true
  oidcIssuerProfile:
    enabled: true
  securityProfile:
    defender:
      securityMonitoring:
        enabled: false
    workloadIdentity:
      enabled: true
    customCATrustConfig:
      enabled: true
  serviceMeshProfile:
    mode: Istio
    istio:
      components:
        ingressGateways:
          - enabled: true
            mode: Internal
      revisions:
        - "asm-1-22"
  agentPoolProfiles:
    - name: sysnpl1
      mode: System
      count: 1
      minCount: 1
      maxCount: 2
      enableAutoScaling: true
      vmSize: placeholder-system-vmsize
      availabilityZones:
        - "1"
        - "2"
        - "3"
      osDiskType: Managed
      osDiskSizeGB: 100
      osType: Linux
      osSKU: AzureLinux
      maxPods: 110
      nodeTaints:
        - CriticalAddonsOnly=true:NoSchedule
      enableCustomCATrust: true
      type: VirtualMachineScaleSets
      orchestratorVersion: placeholder-k8s-version
    - name: usrnpl1
      mode: User
      count: 1
      minCount: 1
      maxCount: 2
      enableAutoScaling: true
      vmSize: placeholder-user-vmsize
      availabilityZones:
        - "1"
        - "2"
        - "3"
      osDiskType: Managed
      osDiskSizeGB: 100
      osType: Linux
      osSKU: AzureLinux
      maxPods: 110
      enableCustomCATrust: true
      type: VirtualMachineScaleSets
      orchestratorVersion: placeholder-k8s-version
      nodeLabels:
        kubernetes.azure.com/scalesetpriority: spot
      nodeTaints:
        - kubernetes.azure.com/scalesetpriority=spot:NoSchedule
  addonProfiles:
    azureKeyvaultSecretsProvider:
      enabled: true
      config:
        enableSecretRotation: false
        rotationPollInterval: placeholder-rotation-interval
    azurepolicy:
      enabled: false
    omsagent:
      enabled: false
      config:
        logAnalyticsWorkspaceResourceID: placeholder-workspace-id
  autoUpgradeProfile:
    upgradeChannel: placeholder-upgrade-channel
    nodeOSUpgradeChannel: placeholder-os-channel
  sshPublicKey:
    keyVaultSecretRef:
      name: placeholder-ssh-secret-name
      vault:
        name: placeholder-keyvault-name
        resourceGroup: placeholder-keyvault-rg
  uptimeSLATier: Standard
